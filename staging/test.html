<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>Virtual Keyboard Simpel - Dragable & Resizable</title>
<style>
  body {
    font-family: Arial, Helvetica, sans-serif;
    background: #0f0f1a;
    color: #e0e0ff;
    display: flex;
    flex-direction: column;
    align-items: center;
    min-height: 100vh;
    margin: 0;
    padding: 20px;
    box-sizing: border-box;
  }

  .output {
    width: 100%;
    max-width: 700px;
    min-height: 80px;
    margin-bottom: 25px;
    padding: 15px;
    font-size: 1.4rem;
    background: #1a1a2e;
    border: 2px solid #444;
    border-radius: 10px;
    white-space: pre-wrap;
    word-break: break-all;
    resize: vertical;
  }

  .keyboard-container {
    position: relative;
    width: fit-content;
    margin: 0 auto;
    cursor: move; /* Default cursor for dragging */
    user-select: none;
    touch-action: none; /* Prevent touch issues */
  }

  .keyboard {
    display: grid;
    grid-template-columns: repeat(14, 50px);
    gap: 6px;
    justify-content: center;
    padding: 10px;
    background: rgba(0, 0, 0, 0.3);
    border-radius: 10px;
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.5);
    transition: transform 0.1s;
  }

  .key {
    height: 52px;
    border: none;
    border-radius: 6px;
    background: linear-gradient(145deg, #2a2a4a, #1e1e38);
    color: white;
    font-size: 1.1rem;
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    user-select: none;
    transition: all 0.12s;
    box-shadow: 0 3px #111827;
  }

  .key:hover { background: #3a3a5a; transform: translateY(-1px); }
  .key:active { transform: translateY(2px); box-shadow: 0 1px #111827; }

  .key.wide { grid-column: span 2; }
  .key.space { grid-column: span 7; background: #252545; }
  .key.backspace { background: #c53030; }
  .key.enter { background: #2f855a; grid-column: span 2; }

  .resize-handle {
    position: absolute;
    bottom: -10px;
    right: -10px;
    width: 20px;
    height: 20px;
    background: #fff;
    border-radius: 50%;
    cursor: nwse-resize;
    box-shadow: 0 2px 4px rgba(0,0,0,0.3);
  }

  /* Responsive adjustments */
  @media (max-width: 768px) {
    .keyboard { grid-template-columns: repeat(14, 40px); }
    .key { height: 42px; font-size: 1rem; }
  }
</style>
</head>
<body>

<h2>Virtual Keyboard Simpel - Dragable & Resizable</h2>

<textarea class="output" id="output" placeholder="Klik tombol di bawah atau ketik di sini..."></textarea>

<div class="keyboard-container" id="keyboard-container">
  <div class="keyboard" id="keyboard"></div>
  <div class="resize-handle" id="resize-handle"></div>
</div>

<script>
// Layout QWERTY Indonesia (mirip US + beberapa karakter khusus)
const layout = [
  "` 1 2 3 4 5 6 7 8 9 0 - =",
  "q w e r t y u i o p [ ] \\",
  "a s d f g h j k l ; '",
  "z x c v b n m , . /",
  "shift space backspace enter"
];

const keyboardContainer = document.getElementById('keyboard-container');
const keyboard = document.getElementById('keyboard');
const resizeHandle = document.getElementById('resize-handle');
const output = document.getElementById('output');

let caps = false;
let isDragging = false;
let isResizing = false;
let startX, startY, startWidth, startHeight, startLeft, startTop;
let scale = 1; // Initial scale for resizing

function createKey(text, className = '') {
  const key = document.createElement('button');
  key.className = 'key ' + className;
  key.textContent = text;
  key.dataset.value = text;
  return key;
}

function buildKeyboard() {
  keyboard.innerHTML = '';

  layout.forEach((row) => {
    const chars = row.split(' ');

    chars.forEach(char => {
      let keyEl;

      if (char === 'space') {
        keyEl = createKey('Space', 'space wide');
        keyEl.dataset.value = ' ';
      } else if (char === 'backspace') {
        keyEl = createKey('← Backspace', 'backspace wide');
        keyEl.dataset.value = 'backspace';
      } else if (char === 'enter') {
        keyEl = createKey('Enter ⏎', 'enter');
        keyEl.dataset.value = '\n';
      } else if (char === 'shift') {
        keyEl = createKey('Shift ⇧', 'wide');
        keyEl.dataset.value = 'shift';
      } else {
        keyEl = createKey(char);
      }

      keyboard.appendChild(keyEl);
    });
  });
}

function insertText(value) {
  if (value === 'shift') {
    caps = !caps;
    updateCaps();
    return;
  }

  if (value === 'backspace') {
    output.value = output.value.slice(0, -1);
    return;
  }

  const start = output.selectionStart;
  const end = output.selectionEnd;
  const text = caps ? value.toUpperCase() : value.toLowerCase();

  output.value = 
    output.value.substring(0, start) +
    text +
    output.value.substring(end);

  output.selectionStart = output.selectionEnd = start + text.length;
  output.focus();
}

function updateCaps() {
  document.querySelectorAll('.key:not(.wide):not(.space):not(.backspace):not(.enter)')
    .forEach(k => {
      const val = k.dataset.value;
      if (val.length === 1 && /[a-zA-Z]/.test(val)) {
        k.textContent = caps ? val.toUpperCase() : val.toLowerCase();
        k.dataset.value = caps ? val.toUpperCase() : val.toLowerCase();
      }
    });
}

function updateScale() {
  keyboard.style.transform = `scale(${scale})`;
  // Adjust gap and sizes dynamically if needed, but for simplicity, we scale the whole keyboard
}

buildKeyboard();
updateCaps();

// Keyboard click handler
keyboard.addEventListener('click', e => {
  if (!e.target.classList.contains('key')) return;
  const value = e.target.dataset.value;
  insertText(value);
});

// Dragging functionality
keyboardContainer.addEventListener('mousedown', (e) => {
  if (e.target === resizeHandle || e.target.classList.contains('key')) return; // Don't drag if resizing or clicking keys
  isDragging = true;
  startX = e.clientX - keyboardContainer.offsetLeft;
  startY = e.clientY - keyboardContainer.offsetTop;
  document.body.style.cursor = 'grabbing';
});

document.addEventListener('mousemove', (e) => {
  if (isDragging) {
    keyboardContainer.style.position = 'absolute';
    keyboardContainer.style.left = `${e.clientX - startX}px`;
    keyboardContainer.style.top = `${e.clientY - startY}px`;
  } else if (isResizing) {
    const newWidth = startWidth + (e.clientX - startX);
    const newHeight = startHeight + (e.clientY - startY);
    scale = Math.min(newWidth / startWidth, newHeight / startHeight); // Uniform scaling
    scale = Math.max(0.5, Math.min(2, scale)); // Limit scale between 0.5x and 2x
    updateScale();
  }
});

document.addEventListener('mouseup', () => {
  isDragging = false;
  isResizing = false;
  document.body.style.cursor = 'default';
});

// Resizing functionality
resizeHandle.addEventListener('mousedown', (e) => {
  isResizing = true;
  startX = e.clientX;
  startY = e.clientY;
  startWidth = keyboard.offsetWidth;
  startHeight = keyboard.offsetHeight;
});

// Touch support for mobile
keyboardContainer.addEventListener('touchstart', (e) => {
  if (e.target === resizeHandle) {
    isResizing = true;
    startX = e.touches[0].clientX;
    startY = e.touches[0].clientY;
    startWidth = keyboard.offsetWidth;
    startHeight = keyboard.offsetHeight;
  } else if (!e.target.classList.contains('key')) {
    isDragging = true;
    startX = e.touches[0].clientX - keyboardContainer.offsetLeft;
    startY = e.touches[0].clientY - keyboardContainer.offsetTop;
  }
});

document.addEventListener('touchmove', (e) => {
  if (isDragging && e.touches.length === 1) {
    keyboardContainer.style.position = 'absolute';
    keyboardContainer.style.left = `${e.touches[0].clientX - startX}px`;
    keyboardContainer.style.top = `${e.touches[0].clientY - startY}px`;
  } else if (isResizing && e.touches.length === 1) {
    const newWidth = startWidth + (e.touches[0].clientX - startX);
    const newHeight = startHeight + (e.touches[0].clientY - startY);
    scale = Math.min(newWidth / startWidth, newHeight / startHeight);
    scale = Math.max(0.5, Math.min(2, scale));
    updateScale();
  }
});

document.addEventListener('touchend', () => {
  isDragging = false;
  isResizing = false;
});

// Biar tetap bisa ketik manual juga
output.addEventListener('keydown', e => {
  if (e.ctrlKey || e.metaKey) return;
  // e.preventDefault(); // Uncomment jika ingin full virtual only
});
</script>

</body>
</html>
